# 订阅管家 (Subscription Tracker) - 需求文档

## 1. 项目概述

### 1.1 项目简介
订阅管家是一个现代化的订阅费用跟踪应用，旨在帮助用户集中管理和监控所有软件订阅，避免意外续费和服务中断，并提供数据分析以便更好地了解订阅支出情况。

### 1.2 业务需求
在数字化时代，用户往往同时订阅多种软件和服务，如流媒体、云存储、生产力工具等。随着订阅数量的增加，用户面临以下挑战：
- 难以追踪所有活跃的订阅及其续费日期
- 忘记取消不再使用的服务导致不必要的支出
- 缺乏对累计订阅费用的全面了解
- 管理不同货币和计费周期的订阅变得复杂

订阅管家旨在解决这些问题，提供一站式订阅管理解决方案。

### 1.3 用户角色
- **普通用户**：管理个人订阅的个体用户

## 2. 功能需求

### 2.1 核心功能

#### 2.1.1 订阅管理
1. **添加订阅**
   - 用户可以手动添加新的订阅记录
   - 必填信息：订阅名称、金额、计费周期、开始日期
   - 选填信息：描述、服务提供商、类别、货币类型等
   - 系统根据开始日期和计费周期自动计算下次付款日期
   
2. **编辑订阅**
   - 用户可以编辑现有订阅的所有信息
   - 编辑后自动更新相关提醒
   
3. **删除订阅**
   - 用户可以删除不再需要跟踪的订阅
   
4. **查看订阅**
   - 提供所有订阅的列表视图
   - 提供即将到期订阅的快速视图
   - 支持按名称、金额、日期等排序和筛选

#### 2.1.2 通知系统
1. **到期提醒**
   - 在订阅到期前根据用户设置的提前天数发送通知
   - 支持每个订阅设置独立的提醒天数
   
2. **通知方式**
   - 支持浏览器通知
   - 支持邮件通知
   
3. **通知设置**
   - 用户可配置是否接收通知及通知方式
   - 用户可设置接收通知的邮箱地址

#### 2.1.3 数据分析和统计
1. **支出概览**
   - 显示月度总支出
   - 显示年度总支出
   - 显示活跃订阅总数
   - 显示即将到期的订阅数量
   
2. **分类统计**
   - 按类别查看支出分布
   - 支持月度和年度视图切换
   
3. **趋势分析**
   - 提供月度支出趋势图表
   - 显示过去12个月的消费情况

#### 2.1.4 AI智能解析
1. **自然语言处理**
   - 用户输入自然语言描述（如"我每月支付Netflix会员89元，从今天开始"）
   - 系统使用AI自动解析并填写订阅详情
   
2. **字段自动补全**
   - 基于解析结果自动填写名称、金额、计费周期等字段
   - 自动计算下次付款日期

#### 2.1.5 数据导入导出
1. **导出功能**
   - 支持将所有订阅数据导出为CSV格式
   
2. **导入功能**
   - 支持从CSV文件导入订阅数据
   - 自动处理和验证导入的数据

### 2.2 UI需求

#### 2.2.1 布局设计
1. **响应式设计**
   - 支持在桌面、平板和手机等不同设备上使用
   - 布局自适应不同屏幕尺寸
   
2. **导航结构**
   - 提供侧边栏导航，包含以下主要页面：
     - 仪表盘
     - 订阅列表
     - 统计分析
     - 设置
   
3. **主题支持**
   - 提供浅色和深色模式
   - 支持自动跟随系统主题设置

#### 2.2.2 页面设计
1. **仪表盘页面**
   - 显示关键统计数据卡片（月度支出、年度支出、活跃订阅数、即将到期订阅数）
   - 显示7天内即将到期的订阅列表
   - 提供"添加新订阅"的快速入口
   
2. **订阅列表页面**
   - 以卡片或表格形式展示所有订阅
   - 提供搜索、排序和筛选功能
   - 每个订阅卡片显示：名称、金额、下次付款日期、剩余天数等
   - 提供编辑和删除操作
   
3. **添加/编辑订阅页面**
   - 提供完整的订阅信息表单
   - 包含AI快速添加功能区域
   - 分组显示基本信息、付款信息和日期信息
   
4. **统计分析页面**
   - 提供各种图表和可视化视图
   - 显示按类别分组的支出
   - 显示月度支出趋势
   
5. **设置页面**
   - 通知偏好设置
   - 数据导入/导出选项

#### 2.2.3 视觉设计
1. **界面风格**
   - 现代简约风格
   - 使用视觉对比增强可读性
   
2. **动画效果**
   - 页面切换的平滑过渡动画
   - 互动元素的反馈动画

### 2.3 非功能需求

#### 2.3.1 性能需求
1. **响应时间**
   - 页面加载时间不超过2秒
   - 用户交互响应时间不超过1秒
   
2. **资源利用**
   - 优化前端资源，确保在低性能设备上也能流畅运行

#### 2.3.2 可靠性需求
1. **数据持久化**
   - 确保所有用户数据安全存储
   - 防止数据丢失
   
2. **错误处理**
   - 提供清晰的错误消息
   - 实现全局错误处理
   - 异常情况下优雅降级

#### 2.3.3 安全需求
1. **数据保护**
   - 保护用户的订阅信息
   - 确保API通信安全

#### 2.3.4 扩展性需求
1. **代码结构**
   - 采用模块化设计，便于扩展
   - 前后端分离架构
   
2. **未来扩展**
   - 预留多用户支持的扩展空间
   - 设计考虑未来功能的集成

## 3. 系统架构

### 3.1 技术栈

#### 3.1.1 前端
- **框架**: React.js
- **状态管理**: React Hooks
- **路由**: React Router
- **样式**: TailwindCSS
- **数据可视化**: Chart.js
- **动画**: Framer Motion
- **HTTP客户端**: Axios

#### 3.1.2 后端
- **运行环境**: Node.js
- **Web框架**: Express
- **数据库**: SQLite
- **定时任务**: Node-cron
- **邮件服务**: Nodemailer
- **AI集成**: OpenAI API或阿里云Qwen API

### 3.2 数据模型

#### 3.2.1 订阅 (Subscription)
- id: 唯一标识符
- name: 订阅名称
- description: 描述信息
- provider: 服务提供商
- amount: 金额
- currency: 货币单位
- billing_cycle: 计费周期（monthly, yearly, quarterly, weekly, daily等）
- cycle_count: 周期计数
- start_date: 开始日期
- next_payment_date: 下次付款日期
- reminder_days: 提醒提前天数
- category: 分类
- active: 是否活跃
- created_at: 创建时间
- updated_at: 更新时间

#### 3.2.2 提醒 (Reminder)
- id: 唯一标识符
- subscription_id: 关联的订阅ID
- reminder_date: 提醒日期
- sent: 是否已发送

#### 3.2.3 通知设置 (NotificationSetting)
- id: 唯一标识符
- email: 通知邮箱
- notify_days_before: 默认提醒提前天数
- email_notifications: 是否启用邮件通知
- browser_notifications: 是否启用浏览器通知

### 3.3 接口设计

#### 3.3.1 订阅API
- GET /api/subscriptions - 获取所有订阅
- GET /api/subscriptions/:id - 获取单个订阅
- POST /api/subscriptions - 创建新订阅
- PUT /api/subscriptions/:id - 更新订阅
- DELETE /api/subscriptions/:id - 删除订阅
- GET /api/subscriptions/upcoming/:days - 获取即将到期的订阅

#### 3.3.2 统计API
- GET /api/statistics/monthly - 获取月度支出统计
- GET /api/statistics/yearly - 获取年度支出统计
- GET /api/statistics/by-category - 获取按类别分组的支出
- GET /api/statistics/monthly-trend - 获取月度支出趋势

#### 3.3.3 通知设置API
- GET /api/notification-settings - 获取通知设置
- PUT /api/notification-settings - 更新通知设置

#### 3.3.4 工具API
- POST /api/parse-subscription - AI解析订阅信息
- GET /api/export-data - 导出订阅数据
- POST /api/import-data - 导入订阅数据

## 4. 实施计划

### 4.1 开发阶段
1. **环境搭建**
   - 设置代码仓库
   - 配置开发环境
   
2. **后端开发**
   - 实现数据库模型
   - 开发API接口
   - 实现定时任务和通知系统
   
3. **前端开发**
   - 实现UI组件和页面
   - 集成API服务
   - 开发数据可视化组件
   
4. **AI集成**
   - 实现自然语言处理接口
   - 集成外部AI服务

### 4.2 测试阶段
1. **单元测试**
   - 测试核心功能和组件
   
2. **集成测试**
   - 测试前后端交互
   - 测试通知系统
   
3. **用户测试**
   - 收集用户反馈
   - 优化用户体验

### 4.3 部署阶段
1. **构建生产版本**
   - 优化前端资源
   - 准备后端部署
   
2. **发布**
   - 部署应用
   - 监控应用性能和异常

## 5. 未来规划

以下功能计划在未来版本中实现：

1. **多用户支持**
   - 添加用户注册和登录
   - 实现用户角色和权限管理
   
2. **移动应用**
   - 开发iOS和Android原生应用
   
3. **高级分析**
   - 提供更丰富的数据分析和预测
   
4. **付款历史记录**
   - 跟踪历史付款记录
   - 生成支出报告
   
5. **货币转换**
   - 支持更多货币
   - 实现实时汇率转换
   
6. **定期自动备份**
   - 自动备份用户数据
   - 支持从备份恢复

## 6. 附录

### 6.1 术语表
- **订阅**：指用户定期支付费用以获得服务或产品的访问权限的协议
- **计费周期**：订阅的付款频率（如每月、每年等）
- **提醒**：在订阅到期前发送的通知
- **AI解析**：使用人工智能从自然语言描述中提取结构化信息

### 6.2 参考资料
- Node.js文档: https://nodejs.org/docs
- React文档: https://react.dev
- Express文档: https://expressjs.com
- TailwindCSS文档: https://tailwindcss.com